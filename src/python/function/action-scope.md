---
title: 函数和变量传递
date: 2025-01-15
category: python
tag:
  - python
---

## 变量作用域

### 作用域分类

- 全局作用域
  - 在整个程序运行环境中都可见
  - 全局作用域中的变量称为全局变量global
- 局部作用域
  - 在函数、类等内部可见
  - 局部作用域中的变量称为局部变量，其使用范围不能超过其所在局部作用域
  - 也称为本地作用域local

### LEGB

在python访问一个变量时，其查找顺序遵循LEGB机制：

- L：local，局部作用域，即函数中定义的变量；
- E：enclosing，嵌套的父级函数的局部作用域，即包含此函数的上级函数的局部作用域；
- G：global，全局变量，即模块级别定义的变量；
- B：built-in，系统固定模块里面的变量，即python的内置作用域。
- 搜索变量的优先级顺序依次是：局部作用域>外层作用域>当前模块中的全局变量>python内置作用域

下面是一个简单的示例：

```python
s = 'aaa'

def f1():
    print(s)

def f2():
    s = 'bbb'
    f1()

f1()
# 输出：aaa
```

在函数 `f1()` 中，变量 `s` 是在全局作用域中定义的，它的值是 `'aaa'`。<br />在函数 `f2()` 中，另一个名为 `s`
的变量被定义为 `'bbb'`，但它只存在于 `f2()` 的本地作用域中。<br />当 `f2()` 调用 `f1()` 时，它会调用全局变量 `s`
，因此输出的值为 `'aaa'`。

### global关键字

如果想在函数中声明全局变量或者改变临时变量，可以使用`global`关键字。<br />如：

```python
def f1():
    global s
    s = "aaa"

def f2():
    print(s)

f1()
f2()
# 输出：aaa
```

在上述代码中，函数`f1()`定义了一个全局变量`s = "aaa"`，首先调用函数`f1()`来声明全局变量，再调用`f2()1`时，变量`s`
被识别为全局变量并输出。<br />如果全局变量是不可变类型，想要在函数中对函数变量进行修改，则需要先在函数内声明其为global，再进行修改；如果是可变数据类型则可以直接修改。

```python
s = "aaa"

def f1():
    print(s)

def f2():
    global s
    s = "bbb"

def f3():
    print(s)

f1()
f2()
f3()
# 输出：
# aaa
# bbb
```
